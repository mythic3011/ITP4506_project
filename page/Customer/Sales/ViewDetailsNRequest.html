<!doctype html>
<head>
    <meta content="text/html; charset=utf-8"/>
    <title>Vehicle - Title</title>
    <!--    <link href="../../../resources/css/VehiclePage.css" rel="stylesheet"/>-->
    <script src="/resources/js/script.js"></script>
    <meta content="noindex, nofollow" name="robots"/>
    <meta content="Legend Motor Company" name="generator"/>
    <meta content="Copyright &copy; 2024 Legend Motor Company" name="copyright"/>
    <meta content="1 days" name="revisit-after"/>
    <link href="../../../resources/image/icon-removebg.png" rel="icon" type="image/x-icon"/>
    <script type="module" src="../../../resources/js/script.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            "50": "#eff6ff",
                            "100": "#dbeafe",
                            "200": "#bfdbfe",
                            "300": "#93c5fd",
                            "400": "#60a5fa",
                            "500": "#3b82f6",
                            "600": "#2563eb",
                            "700": "#1d4ed8",
                            "800": "#1e40af",
                            "900": "#1e3a8a",
                            "950": "#172554"
                        }
                    }
                },
                fontFamily: {
                    'body': [
                        'Inter',
                        'ui-sans-serif',
                        'system-ui',
                        '-apple-system',
                        'system-ui',
                        'Segoe UI',
                        'Roboto',
                        'Helvetica Neue',
                        'Arial',
                        'Noto Sans',
                        'sans-serif',
                        'Apple Color Emoji',
                        'Segoe UI Emoji',
                        'Segoe UI Symbol',
                        'Noto Color Emoji'
                    ],
                    'sans': [
                        'Inter',
                        'ui-sans-serif',
                        'system-ui',
                        '-apple-system',
                        'system-ui',
                        'Segoe UI',
                        'Roboto',
                        'Helvetica Neue',
                        'Arial',
                        'Noto Sans',
                        'sans-serif',
                        'Apple Color Emoji',
                        'Segoe UI Emoji',
                        'Segoe UI Symbol',
                        'Noto Color Emoji'
                    ]
                }
            }
        }
    </script>
    <style>
        .image-slider {
            position: relative;
        }

        .image-slider .slide {
            width: 100%;
        }

        .image-slider .prev,
        .image-slider .next {
            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent background */
        }

        .color-option span:hover,
        .color-option span.selected {
            border: 2px solid #007BFF; /* Highlight selected color */
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white">
<nav class="bg-white border-gray-200 dark:bg-gray-900">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
        <a class="flex items-center space-x-3 rtl:space-x-reverse" href="#">
            <div class="h-8 w-8 relative">
                <img alt="LMC Logo" class="absolute inset-0 object-contain dark:hidden pt-2 dark:pt-1 "
                     src="../../../resources/image/icon-removebg.png"/>
            </div>
            <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">LMC</span>
        </a>

        <div class="flex items-center md:order-2">
            <!-- Dark mode toggle button -->
            <button class="p-2 text-gray-500 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-700"
                    id="darkModeToggle">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                </svg>
            </button>

            <!-- Mobile menu button -->
            <button aria-controls="navbar-default" aria-expanded="false"
                    class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                    id="mobile-menu-button"
                    type="button">
                <span class="sr-only">Open main menu</span>
                <svg aria-hidden="true" class="w-5 h-5" fill="none" viewBox="0 0 17 14"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1h15M1 7h15M1 13h15" stroke="currentColor" stroke-linecap="round"
                          stroke-linejoin="round" stroke-width="2"/>
                </svg>
            </button>
        </div>

        <div class="hidden w-full md:flex md:w-auto md:order-1" id="navbar-default">
            <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
                <li>
                    <a class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"
                       href="viewOrderRecord.html">Order Record</a>
                </li>
                <li>
                    <a class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"
                       href="viewVehicle.php">Vehicle</a>
                </li>
                <li>
                    <a class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"
                       href="shoppingCart.php">Wishlist</a>
                </li>
                <li>
                    <a class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"
                       href="profile.html">Profile</a>
                </li>
                <li>
                    <a class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"
                       href="../../../logout.html" onclick="logout()">Log Out</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!--------------------Menu-------------------->

<!--------------------Vehicle Detail and Request-------------------->
<div class="container mx-auto px-4 py-8" id="VehicleContainer">
    <!--        <script src="../../../resources/js/RequestDetails.js"></script>-->
</div>
<script>
    document.addEventListener('DOMContentLoaded', async function () {
        await initializeCart();
        const VehicleId = getParameterByName('id');

        if (!VehicleId) {
            console.error('Vehicle ID is missing');
            alert('No Vehicle ID provided. Please check the URL and try again.');
            return;
        }

        fetchVehicleDetail(VehicleId)
            .then(vehicle => {
                if (vehicle) {
                    renderVehicle(vehicle);
                } else {
                    throw new Error('Vehicle not found');
                }
            })
            .catch(error => {
                console.error('Error loading Vehicle:', error);
                alert('An error occurred while loading the Vehicle. Please try again later.');
            });
    });

    function getParameterByName(name) {
        const url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
        const results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    async function fetchVehicleDetail(VehicleId) {
        try {
            const response = await fetch("../../../resources/json/vehicles.json");
            const data = await response.json();

            const vehicles = data.map(vehicle => ({
                id: vehicle.id,
                make: vehicle.make,
                model: vehicle.model,
                manufacturingYear: vehicle.manufacturingYear,
                year: vehicle.year,
                price: vehicle.price,
                images: vehicle.images.map(image => ({
                    url: image.url
                })),
                availableColors: vehicle.availableColors.map(color => ({
                    name: color.name,
                    hexCode: color.hexCode
                })),
                upgradeOptions: {
                    interiorUpgrades: vehicle.upgradeOptions.interiorUpgrades.map(option => ({
                        name: option.name,
                        additionalCost: option.additionalCost
                    })),
                    performanceUpgrades: vehicle.upgradeOptions.performanceUpgrades.map(option => ({
                        name: option.name,
                        additionalCost: option.additionalCost
                    })),
                    technologyUpgrades: vehicle.upgradeOptions.technologyUpgrades.map(option => ({
                        name: option.name,
                        additionalCost: option.additionalCost
                    }))
                },
                specifications: {
                    engine: {
                        type: vehicle.specifications.engine.type,
                        cylinderCount: vehicle.specifications.engine.cylinderCount,
                        horsepower: vehicle.specifications.engine.horsepower,
                        torque: vehicle.specifications.engine.torque,
                        drivetrain: vehicle.specifications.engine.drivetrain
                    },
                    transmission: {
                        type: vehicle.specifications.transmission.type,
                        gears: vehicle.specifications.transmission.gears
                    },
                    mileage: {
                        value: vehicle.specifications.mileage.value,
                        unit: vehicle.specifications.mileage.unit
                    },
                    safetyRating: vehicle.specifications.safetyRating,
                    warrantyYears: vehicle.specifications.warrantyYears
                },
                insurancePlans: vehicle.insurancePlans.map(plan => ({
                    planName: plan.planName,
                    annualPremium: plan.annualPremium,
                    coverageLimit: plan.coverageLimit,
                    deductible: plan.deductible
                }))
            }));

            const vehicle = vehicles.find(v => v.id == VehicleId);
            if (vehicle) {
                return vehicle;
            } else {
                window.location.href = "../error/404.html";
            }
        } catch (error) {
            console.error("Error fetching vehicles:", error);
        }
    }


    function renderVehicle(data) {
        // Update page title
        document.title = "Vehicle - " + data.name;

        const Vehicle = data;
        const container = document.getElementById('VehicleContainer');
        container.replaceChildren(); // Clear the container

        const mainDiv = document.createElement('div');
        mainDiv.className = 'bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden max-w-4xl mx-auto mt-8 p-6';

        const mdFlexDiv = document.createElement('div');
        mdFlexDiv.className = 'md:flex';

        // Image Slider Section
        const imgSection = document.createElement('div');
        imgSection.className = 'md:w-1/2 relative';

        // Create slider container
        const sliderContainer = document.createElement('div');
        sliderContainer.className = 'image-slider relative';

        // Create previous and next buttons
        const prevButton = document.createElement('button');
        prevButton.className = 'prev absolute left-0 top-1/2 transform -translate-y-1/2 bg-gray-200 rounded-full p-2 hover:bg-gray-300 focus:outline-none';
        prevButton.innerHTML = '&lt;';

        const nextButton = document.createElement('button');
        nextButton.className = 'next absolute right-0 top-1/2 transform -translate-y-1/2 bg-gray-200 rounded-full p-2 hover:bg-gray-300 focus:outline-none';
        nextButton.innerHTML = '&gt;';

        sliderContainer.appendChild(prevButton);

        // Create slides container
        const slidesContainer = document.createElement('div');
        slidesContainer.className = 'slides';

        const fallbackSvg = 'https://example.com/fallback.svg'; // Fallback image URL

        data.images.forEach((url, index) => {
            const img = document.createElement('img');
            img.src = url;
            img.alt = Vehicle.name;
            img.className = 'slide' + (index === 0 ? '' : ' hidden'); // Only show the first image initially

            // Handle image loading error
            img.onerror = () => {
                img.src = fallbackSvg;  // Set to fallback SVG image
            };

            slidesContainer.appendChild(img);
        });

        sliderContainer.appendChild(slidesContainer);
        imgSection.appendChild(sliderContainer);

        // Info Section
        const infoSection = document.createElement('div');
        infoSection.className = 'md:w-1/2 p-6 flex flex-col justify-between';

        const nameElement = document.createElement('h1');
        nameElement.id = 'VehicleName';
        nameElement.className = 'text-3xl font-bold text-gray-900 dark:text-white mb-4';
        nameElement.textContent = Vehicle.name;

        // Vehicle Number
        const partNoElement = document.createElement('p');
        partNoElement.id = 'VehicleName';
        partNoElement.className = 'text-sm text-gray-600 dark:text-gray-400 mb-4';
        partNoElement.innerHTML = `<span class="font-semibold">Name: </span>${Vehicle.make} ${Vehicle.model}`;

        // Price Section
        const priceDiv = document.createElement('div');
        priceDiv.className = 'flex items-center mb-4';

        const priceLabel = document.createElement('span');
        priceLabel.className = 'text-gray-700 dark:text-gray-300';
        priceLabel.textContent = 'Price:';

        const priceValue = document.createElement('span');
        priceValue.id = 'VehiclePrice';
        priceValue.className = 'text-xl font-bold text-blue-600 dark:text-blue-400 ml-2';
        priceValue.textContent = `$${Vehicle.price}`;
        priceDiv.appendChild(priceLabel);
        priceDiv.appendChild(priceValue);

        // Description


        // Customization Options Section
        const customizationDiv = document.createElement('div');
        customizationDiv.className = 'mb-4';

        // Color Selection
        const colorLabel = document.createElement('label');
        colorLabel.textContent = "Select Color:";
        colorLabel.style.display = 'block';
        colorLabel.style.marginBottom = '8px';
        customizationDiv.appendChild(colorLabel);

        const colorOptionsDiv = document.createElement('div');
        colorOptionsDiv.className = "flex space-x-3 mt-2";

        data.colors.forEach(color => {
            const colorOptionDiv = document.createElement('div');
            colorOptionDiv.style.display = "inline-block";
            colorOptionDiv.style.position = "relative"; // Position for inner elements

            const radioInput = document.createElement('input');
            radioInput.type = "radio";
            radioInput.name = "colorOption";
            radioInput.value = color.hex;
            radioInput.style.display = "none";
            radioInput.alt = color.name;

            const colorDisplay = document.createElement('span');
            colorDisplay.style.display = "inline-block";
            colorDisplay.style.width = "40px";
            colorDisplay.style.height = "40px";
            colorDisplay.style.backgroundColor = color.hex;
            colorDisplay.style.borderRadius = "50%";
            colorDisplay.style.border = "2px solid transparent";
            colorDisplay.style.cursor = "pointer";
            colorDisplay.style.transition = "border-color 0.2s";
            colorDisplay.title = color.name;

            const checkMark = document.createElement('span');
            checkMark.textContent = "âœ“";
            checkMark.style.position = "absolute";
            checkMark.style.right = "5px";
            checkMark.style.bottom = "5px";
            checkMark.style.color = "white";
            checkMark.style.fontSize = "20px";
            checkMark.style.display = "none"; // Initially hidden

            colorDisplay.onclick = () => {
                radioInput.checked = true;
                document.getElementById("Vehicle-Image").style.borderColor = color.hex;
                updateTotalPrice();

                Array.from(colorOptionsDiv.children).forEach(child => {
                    child.children[1].style.borderColor = "transparent"; // Reset border
                    child.children[2].style.display = "none"; // Hide all checkmarks
                });
                colorDisplay.style.borderColor = "#000"; // Highlight selected
                checkMark.style.display = "block"; // Show checkmark
            };

            colorOptionDiv.appendChild(radioInput);
            colorOptionDiv.appendChild(colorDisplay);
            colorOptionDiv.appendChild(checkMark);
            colorOptionsDiv.appendChild(colorOptionDiv);
        });

        customizationDiv.appendChild(colorOptionsDiv);

        infoSection.appendChild(nameElement);
        infoSection.appendChild(partNoElement);
        infoSection.appendChild(priceDiv);
        infoSection.appendChild(customizationDiv);

        // Additional Customization Options for Interior Upgrades
        const interiorOptionsDiv = document.createElement('div');
        interiorOptionsDiv.className = 'mb-4';
        const interiorLabel = document.createElement('label');
        interiorLabel.textContent = "Select Interior Upgrade:";
        interiorOptionsDiv.appendChild(interiorLabel);

        data.upgradeOptions.interior.forEach(option => {
            const interiorOptionDiv = document.createElement('div');

            const checkboxInput = document.createElement('input');
            checkboxInput.type = "checkbox";
            checkboxInput.value = option.name;
            checkboxInput.id = `interior-${option.name}`;
            checkboxInput.onclick = updateTotalPrice; // Update price on selection

            const checkboxLabel = document.createElement('label');
            checkboxLabel.htmlFor = `interior-${option.name}`;
            checkboxLabel.textContent = ` ${option.name} (+$${option.price})`;

            interiorOptionDiv.appendChild(checkboxInput);
            interiorOptionDiv.appendChild(checkboxLabel);
            interiorOptionsDiv.appendChild(interiorOptionDiv);
        });

        infoSection.appendChild(interiorOptionsDiv);

        // Additional Customization Options for Performance Upgrades
        const performanceOptionsDiv = document.createElement('div');
        performanceOptionsDiv.className = 'mb-4';
        const performanceLabel = document.createElement('label');
        performanceLabel.textContent = "Select Performance Upgrade:";
        performanceOptionsDiv.appendChild(performanceLabel);

        data.upgradeOptions.performance.forEach(option => {
            const performanceOptionDiv = document.createElement('div');

            const checkboxInput = document.createElement('input');
            checkboxInput.type = "checkbox";
            checkboxInput.value = option.name;
            checkboxInput.id = `performance-${option.name}`;
            checkboxInput.onclick = updateTotalPrice; // Update price on selection

            const checkboxLabel = document.createElement('label');
            checkboxLabel.htmlFor = `performance-${option.name}`;
            checkboxLabel.textContent = ` ${option.name} (+$${option.price})`;

            performanceOptionDiv.appendChild(checkboxInput);
            performanceOptionDiv.appendChild(checkboxLabel);
            performanceOptionsDiv.appendChild(performanceOptionDiv);
        });

        infoSection.appendChild(performanceOptionsDiv);

        // Additional Customization Options for Technology Upgrades
        const technologyOptionsDiv = document.createElement('div');
        technologyOptionsDiv.className = 'mb-4';
        const technologyLabel = document.createElement('label');
        technologyLabel.textContent = "Select Technology Upgrade:";
        technologyOptionsDiv.appendChild(technologyLabel);

        data.upgradeOptions.technology.forEach(option => {
            const technologyOptionDiv = document.createElement('div');

            const checkboxInput = document.createElement('input');
            checkboxInput.type = "checkbox";
            checkboxInput.value = option.name;
            checkboxInput.id = `technology-${option.name}`;
            checkboxInput.onclick = updateTotalPrice; // Update price on selection

            const checkboxLabel = document.createElement('label');
            checkboxLabel.htmlFor = `technology-${option.name}`;
            checkboxLabel.textContent = ` ${option.name} (+$${option.price})`;

            technologyOptionDiv.appendChild(checkboxInput);
            technologyOptionDiv.appendChild(checkboxLabel);
            technologyOptionsDiv.appendChild(technologyOptionDiv);
        });
        infoSection.appendChild(technologyOptionsDiv);

        // Insurance Options
        const insuranceOptionsDiv = document.createElement('div');
        insuranceOptionsDiv.className = 'mb-4';
        const insuranceOptionsHeader = document.createElement('h4');
        insuranceOptionsHeader.textContent = 'Insurance Options';
        insuranceOptionsDiv.appendChild(insuranceOptionsHeader);
        const insuranceOptionsGrid = document.createElement('div');
        insuranceOptionsGrid.className = 'grid grid-cols-1 md:grid-cols-2 gap-4';

        Vehicle.insuranceOptions.forEach(option => {
            const insuranceOptionDiv = document.createElement('div');
            const insuranceOptionSelect = document.createElement('select');
            insuranceOptionSelect.className = 'bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500';
            insuranceOptionSelect.id = `insuranceOption-${option.planName}`;
            insuranceOptionSelect.required = true;
            insuranceOptionSelect.value = option.planName;
            insuranceOptionSelect.style.display = 'none';

            const insuranceOptionLabel = document.createElement('label');
            insuranceOptionLabel.htmlFor = `insuranceOption-${option.planName}`;
            insuranceOptionLabel.textContent = option.planName;

            const insuranceOptionOption = document.createElement('option');
            insuranceOptionOption.value = option.planName;
            insuranceOptionOption.textContent = option.planName;

            insuranceOptionSelect.appendChild(insuranceOptionLabel);
            insuranceOptionSelect.appendChild(insuranceOptionOption);

            const insuranceOptionPrice = document.createElement('div');
            insuranceOptionPrice.className = 'text-gray-700 dark:text-gray-300 mb-4';
            insuranceOptionPrice.textContent = `$${option.pricePerYear}`;

            insuranceOptionDiv.appendChild(insuranceOptionSelect);
            insuranceOptionDiv.appendChild(insuranceOptionPrice);
            insuranceOptionsGrid.appendChild(insuranceOptionDiv);
        });
        infoSection.appendChild(insuranceOptionsDiv);


        const buttonDiv = document.createElement('div');

        const buyNowButton = document.createElement('button');
        buyNowButton.className = 'bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition duration-150 ease-in-out';
        buyNowButton.id = 'buyNowBtn';
        buyNowButton.textContent = 'Request Vehicle Now';
        buyNowButton.onclick = buyNow;

        const addToWishlistButton = document.createElement('button');
        addToWishlistButton.className = 'bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition duration-150 ease-in-out';
        addToWishlistButton.textContent = 'Add To Wishlist';
        addToWishlistButton.id = 'addToWishlistBtn';
        addToWishlistButton.onclick = {
            handleEvent: () => addToWishlist(data)
        };

        buttonDiv.appendChild(buyNowButton);
        buttonDiv.appendChild(addToWishlistButton);

        infoSection.appendChild(buttonDiv);

        mdFlexDiv.appendChild(imgSection);
        mdFlexDiv.appendChild(infoSection);
        mainDiv.appendChild(mdFlexDiv);
        container.appendChild(mainDiv);

        // Initialize slide functionality
        let slideIndex = 0;

        function showSlides(n) {
            const slidesArray = slidesContainer.getElementsByClassName("slide");
            if (n >= slidesArray.length) {
                slideIndex = 0;
            }
            if (n < 0) {
                slideIndex = slidesArray.length - 1;
            }
            for (let i = 0; i < slidesArray.length; i++) {
                slidesArray[i].classList.add("hidden");
            }
            slidesArray[slideIndex].classList.remove("hidden");
        }

        function changeSlide(n) {
            slideIndex += n;
            showSlides(slideIndex);
        }

        prevButton.onclick = () => {
            changeSlide(-1);
        };
        nextButton.onclick = () => {
            changeSlide(1);
        };

        showSlides(slideIndex); // Show initial slide

        function updateTotalPrice() {
            let totalPrice = Vehicle.price;

            // Add selected interior upgrades to total price
            Array.from(document.querySelectorAll('[id^="interior"]')).forEach(input => {
                if (input.checked) {
                    totalPrice += parseFloat(input.nextSibling.textContent.match(/\+\$(\d+)/)[1]);
                }
            });

            // Add selected performance upgrades to total price
            Array.from(document.querySelectorAll('[id^="performance"]')).forEach(input => {
                if (input.checked) {
                    totalPrice += parseFloat(input.nextSibling.textContent.match(/\+\$(\d+)/)[1]);
                }
            });

            // Add selected technology upgrades to total price
            Array.from(document.querySelectorAll('[id^="technology"]')).forEach(input => {
                if (input.checked) {
                    totalPrice += parseFloat(input.nextSibling.textContent.match(/\+\$(\d+)/)[1]);
                }
            });

            priceValue.textContent = `$${totalPrice.toFixed(2)}`;  // Update displayed price
            highlightSelectedOptions();  // Call function to highlight selected options
        }

        function highlightSelectedOptions() {
            Array.from(document.querySelectorAll('[id^="interior"], [id^="performance"], [id^="technology"]')).forEach(input => {
                if (input.checked) {
                    input.nextSibling.style.fontWeight = 'bold';  // Highlight selected option label
                    input.nextSibling.style.color = '#007BFF';  // Change text color of selected option
                } else {
                    input.nextSibling.style.fontWeight = 'normal';  // Reset label style for unselected options
                    input.nextSibling.style.color = '';  // Reset text color for unselected options
                }
            });
        }
    }


    // Add to Wishlist function
    function addToWishlist(vehicle) {
        let wishlistItems = JSON.parse(localStorage.getItem("LMC_WishList")) || [];
        wishlistItems.push(vehicle);
        localStorage.setItem("LMC_WishList", JSON.stringify(wishlistItems));
        alert(`${vehicle.make} ${vehicle.model} has been added to your wishlist!`);
    }

    // Buy Now function
    function buyNow() {
        alert("Buy Now clicked!");
    }

    // Cart Management Functions

    const CART_KEY_NAME = "LMC_Cart";

    function getCart() {
        return JSON.parse(localStorage.getItem(CART_KEY_NAME)) || [];
    }

    function updateCart(cartItems) {
        localStorage.setItem(CART_KEY_NAME, JSON.stringify(cartItems));
    }

    function addToCart(vehicle) {
        let cartItems = getCart();
        cartItems.push(vehicle); // Add the selected vehicle to cart

        updateCart(cartItems);
        alert(`${vehicle.make} ${vehicle.model} has been added to your cart!`);
    }

    function removeFromCart(vehicleId) {
        let cartItems = getCart();
        cartItems = cartItems.filter(item => item.id !== vehicleId); // Remove the selected vehicle from cart

        updateCart(cartItems);
        alert(`Vehicle with ID ${vehicleId} has been removed from your cart.`);
    }

    function viewCart() {
        let cartItems = getCart();
        if (cartItems.length === 0) {
            alert("Your cart is empty.");
            return;
        }

        let cartDetails = "Your Cart:\n";
        cartItems.forEach(item => {
            cartDetails += `${item.make} ${item.model} - $${item.price}\n`;
        });
        alert(cartDetails);
    }

    // Initialize Cart on Page Load
    async function initializeCart() {
        let cartItems = getCart();
        if (cartItems.length > 0) {
            console.log("Cart initialized with items:", cartItems);
        } else {
            console.log("Cart is empty.");
        }
    }

    // Call initializeCart on page load
    document.addEventListener('DOMContentLoaded', initializeCart);
</script>